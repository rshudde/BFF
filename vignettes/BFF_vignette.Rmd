---
title: "BFF"
output: pdf_document
vignette: >
  %\VignetteIndexEntry{BFF_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
# knitr::opts_chunk$set(
#   collapse = TRUE
# )
```

```{r setup, echo = FALSE}
library(BFF)
library(BSDA)
```
# The following examples will show how the BFF package calculates Bayes factors based on test statistics

## tau2 values recommended by authos
insert latex code i'll send it to you
- section on plotting
-section on general usage (like maximization, setting tau, etc)
- examples for each test

## z - test
```{r z-statistics}
# generating some data
n = 100
data_one = rnorm(n = n, mean = 0.2, sd = 1)
data_two = rnorm(n = n, mean = 0.1, sd = 1)

# calculating test statistics using z.test
# one-sample z-test
z_score_one = z.test(x = data_one, sigma.x = 1)$statistic
  
# two-sample z-test
z_score_two = z.test(x = data_one, y = data_two, sigma.x = 1, sigma.y = 1)$statistic

```

Calculating BFF using z.test.BFF
```{r calculating BFF for z test}
# default r and tau2
z_BFF_one = z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE) #one sample z-test
z_BFF_two = z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE) #two sample z-test
  
# default r and user specified tau2
# single tau2
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, tau2 = 0.5) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, tau2 = 0.5) #two sample z-test
# vector of tau2 values
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, tau2 = c(0.5, 0.8)) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, tau2 = c(0.5, 0.8)) #two sample z-test
  
# user specified r and default tau2
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, r = 2) #one sample z-test, integer r >1  (higher order moments) 
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, r = 2) #two sample z-test, integer r >1  (higher order moments) 
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, r = 2.5) #one sample z-test, continuous r (fractional moments)
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, r = 2.5) #two sample z-test, continuous r (fractional moments)
```

Maximizing r for each specified tau2 using z.test.BFF
```{r maziming r for z test}
# default tau2
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, maximize = TRUE) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, maximize = TRUE) #two sample z-test

# user specified tau2
#single tau2
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, tau2 = 0.5, maximize = TRUE) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, tau2 = 0.5, maximize = TRUE) #two sample z- test
# vector of tau2 values
z.test.BFF(z_stat = z_score_one, n = 100, save = FALSE, tau2 = c(0.5, 0.8), maximize = TRUE) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, tau2 = c(0.5, 0.8), maximize = TRUE) #two sample z-test
```

Plotting with z.test.BFF
```{r plotting for z test}
# saving the plot as a pdf with default name (BFF_plot.pdf). Stored in working directory.
z.test.BFF(z_stat = z_score_one, n = 100, save = TRUE) #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = TRUE) #two sample z-test

# saving the plot as a pdf with user specified name. Stored in working directory.
z.test.BFF(z_stat = z_score_one, n = 100, save = TRUE, savename = "z-BFF-one.pdf") #one sample z-test
z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = TRUE, savename = "z-BFF-two.pdf") #two sample z-test
 
# customizing x-axis labels, y-axis labels and main title
z.test.BFF(z_stat = z_score_one, n = 100, save = TRUE, xlab = "RMSE", ylab = "Logarithm of Bayes Factor", main = "BFF curves") #one sample z-test
z_BFF_two = z.test.BFF(z_stat = z_score_two, one_sample = FALSE, n1 = 100, n2 = 100, save = FALSE, xlab = expression(tilde(omega)), ylab = expression(log(BF[10])), main = "BFF curves") #two sample z-test
```

## t - test
```{r}
# generate some data
n = 100
data_one = rnorm(n = n, mean = -0.1)
data_two = rnorm(n = n, mean = 0.1)

# calculate a test st
t_one = t.test(x = data_one)
t_two = t.test(x = data_one, y = data_two)
t_score_one = t_one$statistic
t_score_two = t_two$statistic
t_df_one = n - 1
t_df_two = 197.9

# calculate a BFF
t_BFF_one = t.test.BFF(t_stat = t_score_one, df = t_df_one, n = 100)
t_BFF_two = t.test.BFF(t_stat = t_score_two, df = t_df_two, one_sample = FALSE, n1 = 100, n2  = 100)

```
## chi^2 - test
```{r}
# generate some data - take from chisq.test example
x <- matrix(c(12, 5, 7, 7), ncol = 2)
chi2_stat = chisq.test(x)$statistic        

# calculate a BFF
chi2_BFF_one = chi2.test.BFF(chi2_stat = chi2_stat, df = 1, n = 4)
```
## F - test
```{r}
# generate some data
n = 100
p = 3
X = matrix(rnorm(n*p), nrow = n)
beta = c(1,1,0)
y = X %*% beta + rnorm(n)
model1 = lm(y ~ X)
anova_model = anova(model1)
F_stat = anova_model$`F value`[1]

# calculate a BFF
F_BFF_one = f.test.BFF(f_stat = F_stat, df1 = anova_model$Df[1], df2 = anova_model$Df[2], n = n)
```






